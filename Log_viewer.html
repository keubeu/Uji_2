<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Log Viewer Modular</title>
  <style>
    body { font-family: sans-serif; padding: 2rem; background: #f7f7f7; }
    h2 { margin-top: 2rem; }
    table { border-collapse: collapse; width: 100%; margin-top: 1rem; }
    th, td { border: 1px solid #ccc; padding: 0.5rem; }
    th { background-color: #eee; }
    .log-block { margin-bottom: 3rem; background: white; padding: 1rem; border-radius: 8px; box-shadow: 0 0 5px #ddd; }
  </style>
</head>
<body>
  <h1>📋 Log Viewer</h1>
  <input type="file" id="fileInput" multiple accept=".json">
  <div id="output"></div>

  <script>
    document.getElementById('fileInput').addEventListener('change', handleFiles);

    function handleFiles(event) {
      const files = event.target.files;
      for (const file of files) {
        const reader = new FileReader();
        reader.onload = (e) => {
          try {
            const json = JSON.parse(e.target.result);
            renderLog(file.name, json);
          } catch (err) {
            renderError(file.name, "Invalid JSON: " + err.message);
          }
        };
        reader.readAsText(file);
      }
    }

    function renderLog(filename, data) {
      const container = document.getElementById('output');
      const div = document.createElement('div');
      div.className = 'log-block';
      div.innerHTML = `<h2>📄 ${filename}</h2>`;

      if (!Array.isArray(data)) {
        div.innerHTML += "<p>⚠️ Data is not an array. Skipping display.</p>";
        container.appendChild(div);
        return;
      }

      if (data.length === 0) {
        div.innerHTML += "<p>🚫 No data entries found.</p>";
        container.appendChild(div);
        return;
      }

      const table = document.createElement('table');
      const keys = Object.keys(data[0]);
      table.innerHTML = `<thead><tr>${keys.map(k => `<th>${k}</th>`).join('')}</tr></thead>`;

      const tbody = document.createElement('tbody');
      data.forEach(entry => {
        const row = document.createElement('tr');
        keys.forEach(key => {
          const cell = document.createElement('td');
          cell.textContent = entry[key] !== undefined ? entry[key] : "";
          row.appendChild(cell);
        });
        tbody.appendChild(row);
      });

      table.appendChild(tbody);
      div.appendChild(table);
      container.appendChild(div);
    }

    function renderError(filename, msg) {
      const container = document.getElementById('output');
      const div = document.createElement('div');
      div.className = 'log-block';
      div.innerHTML = `<h2>📄 ${filename}</h2><p style="color:red;">❌ ${msg}</p>`;
      container.appendChild(div);
    }
  </script>
</body>
</html>
